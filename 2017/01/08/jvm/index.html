<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="柴房"><title>Jvm &amp; GC | 柴房</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Jvm &amp; GC</h1><a id="logo" href="/.">柴房</a><p class="description">试问岭南应不好？却道：此心安处是吾乡。</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Jvm &amp; GC</h1><div class="post-meta">Jan 8, 2017</div><div class="post-content"><h3 id="JVM内存"><a href="#JVM内存" class="headerlink" title="JVM内存"></a>JVM内存</h3><h4 id="程序计数器"><a href="#程序计数器" class="headerlink" title="程序计数器"></a>程序计数器</h4><p>线程私有的，生命周期与线程一致。该计数器指向当前进程执行java代码的行号。<br>对于native方法，则程序计数器中不存储任何信息。</p>
<h4 id="虚拟机栈。"><a href="#虚拟机栈。" class="headerlink" title="虚拟机栈。"></a>虚拟机栈。</h4><p>线程私有的。 每次方法执行的时候都会创建一个栈帧用于存储局部变量表，操作数栈，动态链接，方法出口等信息。<br>每一个方法被调用直到执行完成对应着一个栈帧在虚拟机中从入栈到出栈的过程。</p>
<h4 id="本地方法栈"><a href="#本地方法栈" class="headerlink" title="本地方法栈"></a>本地方法栈</h4><p>线程私有的。虚拟机栈的本地方法版本。</p>
<h4 id="堆"><a href="#堆" class="headerlink" title="堆"></a>堆</h4><p>线程共享的。分为新生代和老年代。</p>
<ul>
<li>因为堆是共享的，所以在进行对象内存分配均需要加锁，这也是new开销大的原因。</li>
<li>Hotspot每一个新线程在堆的新生代中预留一块区域，成为TLAB(Thread-local allocation buffer),所以线程中new小对象相对来说更高效。</li>
</ul>
<h4 id="方法区"><a href="#方法区" class="headerlink" title="方法区"></a>方法区</h4><p>线程共享的。对应于持久代。<br>用于存储类信息，如运行时常量池，成员变量，静态方法，方法名，字节码等，如反射方法，属性等都是来自于方法区。</p>
<h3 id="GC"><a href="#GC" class="headerlink" title="GC"></a>GC</h3><p><img src="http://7xtb44.com1.z0.glb.clouddn.com/heap.jpg" alt=""></p>
<h4 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h4><ul>
<li>GC进程优先级比较低，系统会根据线程优先级调度不定时调用GC。</li>
<li>分代回收,不同的对象的生命周期是不一样的,不同生命周期的对象可以采取不同的回收算法，以便提高回收效率。</li>
<li>什么是垃圾<br>对非线程对象，所有的线程都不能访问到该对象。<br>对线程对象，所有其他线程不能含该线程的引用，且线程已停止。  </li>
<li>Scavenge GC<br>一般情况下，当新对象生成，并且在Eden申请空间失败时，就会触发Scavenge GC，对Eden区域进行GC，清除非存活对象，并且把尚且存活的对象移动到Survivor区。然后整理Survivor的两个区。这种方式的GC是对年轻代的Eden区进行，不会影响到年老代。因为大部分对象都是从Eden区开始的，同时Eden区不会分配的很大，所以Eden区的GC会频繁进行。因而，一般在这里需要使用速度快、效率高的算法，使Eden去能尽快空闲出来。</li>
<li>Full GC<br>对整个堆进行整理，特点是慢。老年代或者永久带被写满，system.gc()被显式调用，或者堆分配策略变动之前都会触发。</li>
</ul>
<h4 id="堆-1"><a href="#堆-1" class="headerlink" title="堆"></a>堆</h4><ul>
<li><p>新生代(Young Generation)分为Eden Space，S0 Suvivor Space，S1 Survivor Space<br>new的对象一开始都会存于Eden Space<br>存在时间较长，经过垃圾回收没有被清除的实例，就从Eden 搬到了S0<br>存在时间更长的实例，就从S0 搬到了S1</p>
</li>
<li><p>老年代(Old Generation)<br>存在时间更长的实例，对象多次回收没被清除，就从S1 搬到了Old Generation</p>
</li>
<li><p>永久带<br>永久带就是方法区</p>
</li>
</ul>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://segmentfault.com/a/1190000002579346#articleHeader2" target="_blank" rel="external">JVM工作原理</a></li>
<li><a href="http://www.cnblogs.com/sunniest/p/4575144.html" target="_blank" rel="external">Java回收机制</a></li>
</ul>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://fangzhirui.github.io/2017/01/08/jvm/" data-id="cjgv00qbi000h98qcq9ghb2i2" class="article-share-link">分享到</a><div class="tags"><a href="/tags/back/">back</a></div><div class="post-nav"><a href="/2016/12/15/This-love/" class="next">This love</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://fangzhirui.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/node-js/" style="font-size: 15px;">node.js</a> <a href="/tags/front/" style="font-size: 15px;">front</a> <a href="/tags/back/" style="font-size: 15px;">back</a> <a href="/tags/杂谈/" style="font-size: 15px;">杂谈</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/01/08/jvm/">Jvm & GC</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/15/This-love/">This love</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/08/Interview Summary 201612/">Interview Summary 201612</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/10/Interview Summary 201611/">Interview Summary 201611</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/12/ES6-Promise/">ES6 Promise</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/17/train-tickets/">瞄火车票的爬虫</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/19/regex01/">正则式匹配EXIF字符串</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/01/09/frontend/">前端备忘</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/01/66/">CreateJs的demo</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/09/10/jqplugin/">自定义jq插件</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://fangzhirui.github.io/" title="My Git" target="_blank">My Git</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">柴房.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>